<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø¯ÙØ¹ - Ø§Ù„Ø´Ù…Ø§Ø¹</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="cart-styles.css">
    <style>
        .checkout-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .checkout-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .checkout-section h2 {
            color: #1e3a8a;
            margin-bottom: 20px;
            border-bottom: 2px solid #e1e5e9;
            padding-bottom: 10px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .payment-methods {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .payment-method {
            flex: 1;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-method:hover {
            border-color: #1e3a8a;
        }

        .payment-method.selected {
            border-color: #1e3a8a;
            background-color: #f0f4ff;
        }

        .payment-method input[type="radio"] {
            display: none;
        }

        .order-summary {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .order-item:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1em;
        }

        .checkout-btn {
            background: linear-gradient(135deg, #1e3a8a, #2c5aa0);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 58, 138, 0.3);
        }

        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 20px;
            text-decoration: none;
            display: inline-block;
        }

        .back-btn:hover {
            background: #5a6268;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-top">
            <div class="logo">
                <a href="index.html"><img src="11zon_cropped.jpg" alt="Ø§Ù„Ø´Ù…Ø§Ø¹"></a>
            </div>
            <div class="user-actions">
                <a href="buyer.html">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ³ÙˆÙ‚</a>
            </div>
        </div>
    </header>

    <main>
        <div class="checkout-container">
            <a href="buyer.html" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ³ÙˆÙ‚</a>

            <div class="checkout-section">
                <h2>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø­Ù†</h2>
                <form id="shipping-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="first-name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„:</label>
                            <input type="text" id="first-name" required>
                        </div>
                        <div class="form-group">
                            <label for="last-name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±:</label>
                            <input type="text" id="last-name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
                        <input type="tel" id="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
                        <textarea id="address" rows="3" required></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label>
                            <input type="text" id="city" required>
                        </div>
                        <div class="form-group">
                            <label for="postal-code">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ:</label>
                            <input type="text" id="postal-code">
                        </div>
                    </div>
                </form>
            </div>

            <div class="checkout-section">
                <h2>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</h2>
                <div class="payment-methods">
                    <div class="payment-method selected" data-method="cash">
                        <input type="radio" id="cash" name="payment-method" value="cash" checked>
                        <label for="cash">
                            <h3>ğŸ’° Ø¯ÙØ¹ Ù†Ù‚Ø¯ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</h3>
                            <p>Ø§Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</p>
                        </label>
                    </div>
                    <div class="payment-method" data-method="card">
                        <input type="radio" id="card" name="payment-method" value="card">
                        <label for="card">
                            <h3>ğŸ’³ Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©</h3>
                            <p>Ø§Ø¯ÙØ¹ Ø§Ù„Ø¢Ù† Ø¨Ø¨Ø·Ø§Ù‚ØªÙƒ Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©</p>
                        </label>
                    </div>
                </div>

                <div id="card-details" style="display: none; margin-top: 20px;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="card-number">Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©:</label>
                            <input type="text" id="card-number" placeholder="1234 5678 9012 3456">
                        </div>
                        <div class="form-group">
                            <label for="expiry-date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</label>
                            <input type="text" id="expiry-date" placeholder="MM/YY">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cvv">CVV:</label>
                            <input type="text" id="cvv" placeholder="123">
                        </div>
                        <div class="form-group">
                            <label for="card-name">Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©:</label>
                            <input type="text" id="card-name">
                        </div>
                    </div>
                </div>
            </div>

            <div class="checkout-section">
                <h2>Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h2>
                <div id="order-summary" class="order-summary">
                    <!-- Order summary will be populated by JavaScript -->
                </div>
                <button id="place-order-btn" class="checkout-btn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
            </div>
        </div>
    </main>

    <footer>
        <div style="text-align: center; padding: 20px; background-color: #f8f9fa; border-top: 1px solid #dee2e6;">
            <p>&copy; 2025 Ø§Ù„Ø´Ù…Ø§Ø¹. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
        </div>
    </footer>

    <script>
        // Load cart and display order summary
        function loadOrderSummary() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const orderSummary = document.getElementById('order-summary');

            if (cart.length === 0) {
                orderSummary.innerHTML = '<p>Ø§Ù„Ø¹Ø±Ø¨Ø© ÙØ§Ø±ØºØ©</p>';
                return;
            }

            let total = 0;
            let html = '';

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                html += `
                    <div class="order-item">
                        <span>${item.name} (${item.size}) Ã— ${item.quantity}</span>
                        <span>${itemTotal.toLocaleString('ar-EG')} Ø¬Ù†ÙŠÙ‡</span>
                    </div>
                `;
            });

            // Add delivery cost (assuming 30 EGP for Cairo)
            const deliveryCost = 30;
            total += deliveryCost;

            html += `
                <div class="order-item">
                    <span>ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„</span>
                    <span>${deliveryCost} Ø¬Ù†ÙŠÙ‡</span>
                </div>
                <div class="order-item">
                    <span><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</strong></span>
                    <span><strong>${total.toLocaleString('ar-EG')} Ø¬Ù†ÙŠÙ‡</strong></span>
                </div>
            `;

            orderSummary.innerHTML = html;
        }

        // Payment method selection
        document.querySelectorAll('.payment-method').forEach(method => {
            method.addEventListener('click', function() {
                document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
                this.classList.add('selected');

                const radio = this.querySelector('input[type="radio"]');
                radio.checked = true;

                const cardDetails = document.getElementById('card-details');
                if (radio.value === 'card') {
                    cardDetails.style.display = 'block';
                } else {
                    cardDetails.style.display = 'none';
                }
            });
        });

        // Place order
        document.getElementById('place-order-btn').addEventListener('click', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!');
                window.location.href = 'login.html';
                return;
            }

            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart.length === 0) {
                alert('Ø§Ù„Ø¹Ø±Ø¨Ø© ÙØ§Ø±ØºØ©!');
                return;
            }

            // Validate shipping form
            const shippingForm = document.getElementById('shipping-form');
            if (!shippingForm.checkValidity()) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø­Ù†!');
                return;
            }

            // Get shipping info
            const shippingInfo = {
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                postalCode: document.getElementById('postal-code').value
            };

            // Get payment method
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;

            // Calculate total
            let total = 0;
            cart.forEach(item => {
                total += item.price * item.quantity;
            });
            total += 30; // Delivery cost

            // Create order
            const order = {
                id: Date.now(),
                customer: {
                    name: `${shippingInfo.firstName} ${shippingInfo.lastName}`,
                    email: shippingInfo.email,
                    phone: shippingInfo.phone,
                    address: `${shippingInfo.address}, ${shippingInfo.city}`
                },
                items: cart,
                total: total,
                payment: {
                    method: paymentMethod
                },
                status: 'pending',
                date: new Date().toISOString()
            };

            // Save order
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));

            // Clear cart
            localStorage.removeItem('cart');

            // Show success message and redirect
            alert('ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ' + order.id);
            window.location.href = 'buyer.html';
        });

        // Load user info if logged in
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (currentUser) {
            document.getElementById('email').value = currentUser.email;
            document.getElementById('first-name').value = currentUser.fullName.split(' ')[0] || '';
            document.getElementById('last-name').value = currentUser.fullName.split(' ').slice(1).join(' ') || '';
            document.getElementById('phone').value = currentUser.phone || '';
            document.getElementById('address').value = currentUser.address || '';
        }

        // Initialize
        loadOrderSummary();
    </script>
</body>
</html>
